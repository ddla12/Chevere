(()=>{"use strict";const t={getElementsBy(t){const e=[...t.element.querySelectorAll(t.selector)];return{type:t.attribute,nodes:e.map((e=>new t.Child({element:e,parent:t.parent,attr:{attribute:t.attribute,values:{original:e.getAttribute(t.attribute)}}})))}},parser:t=>new Function([...t.args?.keys()||""].join(","),`return ${t.expr}`).bind(t.node)(...t.args?.values()||""),getElementsByDataOn(t){const a=e.bindOrOn(t.attribute),r=[...t.parent.element.querySelectorAll("*")].filter((t=>[...t.attributes].map((t=>t.name)).some((t=>a.test(t)))));return{type:`data-${t.attribute}`,nodes:r.map((e=>new t.Child({element:e,parent:t.parent,attr:[...e.attributes].map((t=>t.name)).filter((t=>a.test(t))).map((t=>({attribute:t,values:{original:e.getAttribute(t)}})))})))}},eventCallback:t=>new Function("$event, $el",t.expr).bind(t.node,t.$event,t.node.element)()},e={loop:t=>new RegExp(String.raw`^${t}|(?<=\[)${t}(?=\])|(?!\,)${t}(?=\,)|(?<=\:(\s+)?)${t}|(?<=\,|\()${t}`,"g"),$this:t=>new RegExp(String.raw`^this\.${t}\.[a-zA-Z]`,"g"),bindOrOn:t=>new RegExp(String.raw`^data-${t}:|@${t}`)},a=String.raw`^(\!)?(true|false|this\.data\.\w+)`,r={$data:e.$this("data"),arguments:/(?<=\().*(?=\))/g,isLogicalExpression:new RegExp(String.raw`${a}(\s+)?(\||&|=|!=|(>|<)(=)?)`),isVariableAssign:/^this\.data\.\w+(\s)?(\?\?||\+|\-|\*|\/|\%|\*\*|<<?|>>(>)?|\|(\|)?||\&(\&)?|\^)?=/,isString:/^(\`).*\1$/,isObject:/^\{.*\}$/,isBoolean:new RegExp(`${a}$`),methodSyntax:/(^\w+$)|(^.*?\((.*)?\)$)/,bindAndOn:/^(data-(on|bind):|@(on|bind))/,bind:/^(data-)/,for:/^\w+(\s+)in(\s+)this\.data\.\w+/,forParent:/this\..*/g};class s{constructor(t){({name:this.name,data:this.data,methods:this.methods,init:this.init,watch:this.watch,updated:this.updated,updating:this.updating}=t),this.watch&&Object.keys(this.watch).some((t=>{if(!this.data[t])throw new ReferenceError(`You're trying to watch an undefined property '${t}'`)})),Object.freeze(this)}async initFunc(e){let a=e?e?.split(",").map((e=>t.parser({expr:e}))):[];await this.init(...a||"")}}class i{constructor(t){({element:this.element,parent:this.parent,attr:this.attr}=t)}setAction(){}ifAttrIsEmpty(t){if(!t.values.original)throw new SyntaxError(`The '${t.attribute}' attribute cannot be empty`)}}class n extends i{constructor(t){super(t),this.attr?.some((t=>this.ifAttrIsEmpty(t))),this.parseAttribute()}refreshAttribute(){let e=this.attr.map((t=>t.attribute.replace(r.bindAndOn,"").replace(/\..*/,"")));this.attr.forEach(((a,r)=>{("window"!=a.attribute.replace(/^.*\./,"")?this.element:window).addEventListener(e[r],(e=>{t.eventCallback({$event:e,expr:a.values.original.includes("$emitSelf")?a.values.original:`$event.stopPropagation();${a.values.original}`,node:this.parent})}))}))}parseAttribute(){try{if(this.attr.some((t=>!r.methodSyntax.test(t.values.original)&&!r.isVariableAssign.test(t.values.original))))throw new SyntaxError("A 'data-on' attribute only accepts a method or a assignment as value");this.refreshAttribute()}catch(t){console.error(t)}}}class l extends i{constructor(t){if(super(t),this.variables={loop:this.element.dataset.for.match(/^\w+/)[0],parent:this.element.dataset.for.match(r.forParent)[0].replace("this.data.","")},this.templates={content:this.element.content,fragment:document.createDocumentFragment()},1!=this.templates.content.querySelectorAll(":scope > *").length)throw new Error("A template with 'data-for' attribute can only have one direct child");this.parseAttribute()}refreshAttribute(){if(!(this.parent.data[this.variables.parent]instanceof Array))throw new TypeError(`Cannot execute a for loop with the '${this.variables.parent}' variable,it must be an array`);this.parent.data[this.variables.parent].forEach(((t,a)=>{const r=[...this.templates.content.querySelectorAll("*")],s={before:`this.data.${this.variables.parent}[${a-1}]`,current:`this.data.${this.variables.parent}[${a}]`};r.forEach((t=>{[...t.attributes].filter((t=>t.textContent.includes(0==a?this.variables.loop:s.before))).forEach((t=>{t.textContent=t.textContent.replace(0==a?e.loop(this.variables.loop):s.before,s.current)}))})),this.templates.fragment.append(document.importNode(this.templates.content,!0))})),this.parent.element.append(this.templates.fragment)}parseAttribute(){try{if(!r.for.test(this.attr.values.original))throw new SyntaxError("data-for attribute must follow the pattern 'var in vars'");this.refreshAttribute()}catch(t){console.error(t)}}}class h extends i{constructor(t){super(t),this.variable=this.attr.values.original.replace("this.data.",""),this.inputType=this.element.type,"checkbox"==this.inputType&&(this.related=[...this.parent.element.querySelectorAll(`input[type='checkbox'][data-model='this.data.${this.variable}']`)].filter((t=>t!=this.element))),this.ifAttrIsEmpty(this.attr),this.parseAttribute()}bindData(){["radio","checkbox"].includes(this.inputType)||(this.element.value=String(this.parent.data[this.variable]))}setAction(){this.parent.data[this.variable]="checkbox"!=this.inputType?this.element.value:this.related?.length?[...this.related,this.element].filter((t=>t.checked)).map((t=>t.value)).join(","):this.element.checked}refreshAttribute(){this.element.addEventListener("input",this.setAction.bind(this)),this.bindData()}parseAttribute(){try{if(!this.attr?.values.original.match(r.$data))throw new SyntaxError("The 'data-model' attribute only accept a property reference as value");this.refreshAttribute()}catch(t){console.error(t)}}}class o extends i{constructor(t){super(t),this.ifAttrIsEmpty(this.attr),this.parseAttribute()}setAction(){this.element.textContent=this.attr.values.current()}refreshAttribute(){this.attr.values.current=()=>t.parser({expr:this.attr?.values.original,node:this.parent}),this.setAction()}parseAttribute(){try{if(r.isObject.test(this.attr?.values.original)||r.methodSyntax.test(this.attr?.values.original))throw new SyntaxError("The 'data-text' attribute only accept strings concatenation, and a variable as reference");this.refreshAttribute()}catch(t){console.error(t)}}}class d extends i{constructor(t){super(t),this.display=getComputedStyle(this.element).display,this.ifAttrIsEmpty(this.attr),this.parseAttribute()}setAction(){this.element.style.display=this.attr.values.current()?this.display:"none"}refreshAttribute(){this.attr.values.current=()=>t.parser({expr:this.attr.values.original,node:this.parent}),this.setAction()}parseAttribute(){try{if(!r.isBoolean.test(this.attr.values.original)&&!r.isLogicalExpression.test(this.attr.values.original))throw new SyntaxError("data-show attribute only accept booleans");this.refreshAttribute()}catch(t){console.error(t)}}}class c extends i{constructor(t){super(t),t.attr.some((t=>this.ifAttrIsEmpty(t))),this.attr=t.attr.map((t=>({attribute:t.attribute,values:{original:t.values.original},bindAttr:t.attribute.replace(r.bindAndOn,""),bindValue:this.element.dataset[t.attribute.replace(r.bindAndOn,"")]||"",type:r.isString.test(t.values.original)?"string":r.isObject.test(t.values.original)?"object":"variable"}))),this.parseAttribute()}setAction(){this.attr.forEach((t=>t.predicate()))}refreshAttribute(){this.attr.filter((t=>["style","class"].includes(t.bindAttr))).forEach((e=>{let a=this.attr.indexOf(e);this.attr[a].values.current=()=>t.parser({expr:this.attr[a].values.original,node:this.parent})}));const[e,a]=[this.attr.findIndex((t=>"style"==t.bindAttr)),this.attr.findIndex((t=>"class"==t.bindAttr))];this.attr[e]&&(this.attr[e].predicate=()=>["string","variable"].includes(this.attr[e].type)?this.element.style.cssText=this.attr[e].values.current()+this.attr[e].bindValue:Object.assign(this.element.style,this.attr[e].values.current())),this.attr[a]&&(this.attr[a].predicate=()=>this.element.className=["string","variable"].includes(this.attr[a].type)?this.attr[a].values.current()+" ":Object.entries(this.attr[a].values.current()).filter((([,t])=>t)).map((([t])=>t)).join(" ")+" "+this.attr[a].bindValue),this.attr.filter((t=>!["style","class"].includes(t.bindAttr))).forEach((e=>{if(r.isObject.test(e.values.original))throw new SyntaxError("Only 'style' and 'class' attribute accepts an object as value /\n                    any other atttribute can only receive either a variable or a template string");let a=this.attr.indexOf(e);this.attr[a].values.current=()=>t.parser({expr:this.attr[a].values.original,node:this.parent}),e.predicate=()=>this.element.setAttribute(e.bindAttr,e.values.current())})),this.setAction()}parseAttribute(){try{if(this.attr.some((t=>!r.isString.test(t.values.original)&&!r.isObject.test(t.values.original))))throw new SyntaxError("A 'data-bind' attribute only accepts an object or a template string as value");this.refreshAttribute()}catch(t){console.error(t)}}}class u{constructor(t){this.childs={"data-on":[],"data-text":[],"data-model":[],"data-for":[],"data-show":[],"data-bind":[]},this.element=t,this.id=this.element.dataset.id=this.setId()}setId(){return Math.random().toString(32).substr(2)}findRefs(){this.refs=[...this.element.querySelectorAll("*[data-ref]")].reduce(((t,e)=>{if(!e.dataset.ref)throw new SyntaxError("data-ref attribute cannot be empty");if(Object.keys({...t}).some((t=>t==e.dataset.ref)))throw new SyntaxError("It seems like there are repeated 'data-ref' values, check your 'data-ref' attributes");return{...t,[e.dataset.ref]:e}}),{})}refreshChilds(t,e){this.childs[t].filter((t=>t.attr?.values.original.includes(e))).forEach((t=>{t.setAction()}))}$emit(t){window.dispatchEvent(new CustomEvent(t.name,{detail:t.detail,bubbles:!0,composed:!0,cancelable:!0}))}setChilds(t){t.nodes.forEach((e=>{this.childs[t.type].push(e)}))}checkForActionsAndChilds(){if(this.element.querySelectorAll("*[data-inline], *[data-attached]").length)throw Error("Child components is an unsupported feature, sorry about that");[t.getElementsBy({attribute:"data-for",element:this.element,parent:this,selector:"template[data-for]",Child:l}),t.getElementsBy({attribute:"data-text",element:this.element,parent:this,selector:"*[data-text]",Child:o}),t.getElementsBy({attribute:"data-show",element:this.element,parent:this,selector:"*[data-show]",Child:d}),t.getElementsBy({attribute:"data-model",element:this.element,parent:this,selector:"input[data-model], select[data-model], textarea[data-model]",Child:h}),t.getElementsByDataOn({attribute:"on",Child:n,parent:this}),t.getElementsByDataOn({attribute:"bind",Child:c,parent:this})].forEach((t=>t.nodes.length&&this.setChilds(t)))}$emitSelf(t){this.childs["data-on"].filter((e=>e.attr.some((e=>e.attribute.includes(t.name))))).forEach((e=>e.element.dispatchEvent(new CustomEvent(t.name,{detail:t.detail,bubbles:!0,composed:!0,cancelable:!0}))))}updateRelated(t){["data-show","data-text"].forEach((e=>this.refreshChilds(e,t))),this.childs["data-model"].filter((e=>e.variable==t)).forEach((t=>t.bindData())),this.childs["data-bind"].forEach((t=>t.setAction()))}}class p extends u{constructor(t,e){super(e),({name:this.name,methods:this.methods,watch:this.watch,updated:this.updated,updating:this.updating}=t),this.data=this.parseData(t.data),this.methods&&this.parseMethods(),this.checkForActionsAndChilds(),this.findRefs(),Object.seal(this)}parseData(t){return new Proxy(t,{get:(t,e,a)=>Reflect.get(t,e,a),set:(t,e,a,r)=>(this.updating&&this.updating(),this.watch&&this.watch[e]?.apply(this,[a,t[e]]),Reflect.set(t,e,a,r),this.updateRelated(e),this.updated&&this.updated(),!0)})}parseMethods(){this.methods=Object.values(this.methods).reduce(((t,e)=>({...t,[e.name]:new Proxy(e,{apply:(t,e,a)=>{this.updating&&this.updating(),t.apply(this,[...a]),this.updated&&this.updated()}})})),{})}}class m extends u{constructor(e){super(e),this.data={},this.data=this.parseData(t.parser({expr:this.element.dataset.inline||"{}"})),this.checkForActionsAndChilds(),this.findRefs(),Object.seal(this)}parseData(t){return new Proxy(t,{get:(t,e,a)=>Reflect.get(t,e,a),set:(t,e,a,r)=>(Reflect.set(t,e,a,r),this.updateRelated(e),!0)})}}const b={findItsData(t,...e){let a=e.find((e=>e.name==t.trim().replace(/\(.*/,"")));if(!a)throw new ReferenceError(`'${t}' couldn't be found in any of your declared components`);return a},start(...t){[...document.querySelectorAll("*[data-attached]")].map((t=>({el:t,attr:t.dataset.attached}))).forEach((async e=>{const a=this.findItsData(e.attr,...t);if(!r.methodSyntax.test(e.attr))throw new SyntaxError(`There are syntax error in the 'data-attached' attribute, unrecognized expression "${e.attr}"`);if(null==a.init&&r.arguments.test(e.attr))throw new EvalError(`The ${a.name} components don't have an init() function, therefore they do not accept any parameters`);null!=a.init&&await(async()=>r.arguments.test(e.attr)?a.initFunc(e.attr.match(r.arguments).join(",")):a.initFunc())(),new p(a,e.el)})),[...document.querySelectorAll("*[data-inline]")].map((t=>new m(t)))},data:t=>new s(t)};Object.defineProperty(window,"Chevere",{value:b})})();