(()=>{"use strict";const t={getElementsBy:t=>[...t.$element.querySelectorAll(t.selector)].map((e=>new t.Child({$element:e,parent:t.parent,attr:{attribute:t.attribute,values:{original:e.getAttribute(t.attribute)}}}))),parser:t=>new Function([...t.args?.keys()||""].join(","),`return ${t.expr}`).bind(t.node)(...t.args?.values()||""),getElementsByDataOn(t){const a=e.bindOrOn(t.attribute);return[...t.parent.$element.querySelectorAll(t.rescan?"*[data-key]":"*")].filter((t=>[...t.attributes].map((t=>t.name)).some((t=>a.test(t))))).map((e=>new t.Child({$element:e,parent:t.parent,attr:[...e.attributes].map((t=>t.name)).filter((t=>a.test(t))).map((t=>({attribute:t,values:{original:e.getAttribute(t)}})))})))},eventCallback:t=>new Function(`$event, $el, ${[...t.args.keys()].join(",")}`,t.expr).apply(t.node,[t.$event,t.$el,...t.args.values()]),reactive:t=>new Proxy(t.object,{get:(t,e,a)=>Reflect.get(t,e,a),set:(e,a,s,r)=>(t.beforeSet&&t.beforeSet(e,a,s),Reflect.set(e,a,s,r),t.afterSet&&t.afterSet(e,a,s),!0)}),setId:()=>Math.random().toString(32).substr(2)},e={$this:t=>new RegExp(String.raw`^this\.${t}\.[a-zA-Z]`,"g"),bindOrOn:t=>new RegExp(String.raw`^data-${t}:|@${t}`)},a=String.raw`^(\!)?(true|false|this\.data\.\w+)`,s={$data:e.$this("data"),arguments:/(?<=\().*(?=\))/g,removePar:/.*\(|\)$/g,isLogicalExpression:new RegExp(String.raw`${a}(\s+)?(\||&|=|!=|(>|<)(=)?)`,"s"),isVariableAssign:/^this\.data\.\w+(\s)?(\?\?||\+|\-|\*|\/|\%|\*\*|<<?|>>(>)?|\|(\|)?||\&(\&)?|\^)?=/s,isString:/^(\`).*\1$/,isObject:/^\{.*\}$/,isBoolean:new RegExp(`${a}$`),methodSyntax:/^.*\((.*)?\)$/s,bindAndOn:/^(data-(on|bind):|@(on|bind))/,bind:/^(data-)/,for:/^\w+(\s+)in(\s+)this\.data\.\w+/,forParent:/this\..*/g};class r{constructor(e){this.readAttribute=t=>{try{t(),this.setAction()}catch(t){console.error(t)}},({$element:this.$element,parent:this.parent,attr:this.attr}=e),this.forVars=new Map([...Object.entries(t.parser({expr:this.$element.dataset.forRef||"{}",node:this.parent}))||[]])}ifAttrIsEmpty(t){if(!t.values.original)throw new SyntaxError(`The '${t.attribute}' attribute cannot be empty`)}}class i extends r{constructor(t){super(t),this.attr?.some((t=>this.ifAttrIsEmpty(t))),this.readAttribute((()=>{if(this.attr.some((t=>!s.methodSyntax.test(t.values.original)&&!s.isVariableAssign.test(t.values.original))))throw new SyntaxError("A 'data-on' attribute only accepts a method or a assignment as value")}))}refresh(){}setAction(){let e=this.attr.map((t=>t.attribute.replace(s.bindAndOn,"").replace(/\..*/,"")));this.attr.forEach(((a,s)=>{("window"!=a.attribute.replace(/^.*\./,"")?this.$element:window).addEventListener(e[s],(e=>{t.eventCallback({$event:e,expr:a.values.original.includes("$emitSelf")?a.values.original:`$event.stopPropagation();${a.values.original}`,node:this.parent,$el:this.$element,args:this.forVars})}))}))}}class n extends r{constructor(e){if(super(e),this.id=t.setId(),this.pos=[...this.parent.$element.children].indexOf(this.$element),this.variables={loop:this.$element.dataset.for.match(/^\w+/)[0],parent:this.$element.dataset.for.match(s.forParent)[0].replace("this.data.","")},this.templates={content:this.$element.content,fragment:document.createDocumentFragment()},this.key=`${Object.values(this.variables).join("-")}-${this.id}`,1!=this.templates.content.querySelectorAll(":scope > *").length)throw new Error("A template with 'data-for' attribute can only have one direct child");this.readAttribute((()=>{if(!s.for.test(this.attr.values.original))throw new SyntaxError("data-for attribute must follow the pattern 'var in vars'")}))}refresh(){Object.entries(this.parent.childs).forEach((([t,e])=>{this.parent.childs[t]=e.filter((t=>!t.$element.dataset.key))})),[...this.parent.$element.querySelectorAll(`*[data-key=${this.key}]`)].forEach((t=>t.remove())),this.refresh(),this.parent.reScan()}setAction(){if(!(this.parent.data[this.variables.parent]instanceof Array))throw new TypeError(`Cannot execute a for loop with the '${this.variables.parent}' variable,it must be an array`);this.parent.data[this.variables.parent].forEach(((e,a)=>{const s=[...this.templates.content.querySelectorAll("*")];[s[0].dataset.key,s[0].id]=[this.key,t.setId()];const r=`this.data.${this.variables.parent}[${a}]`;s.filter((t=>Object.keys(t.dataset).length||[...[...t.attributes].map((t=>t.name))].includes("@"))).forEach((t=>t.dataset.forRef=`{ ${this.variables.loop}: ${r} }`)),this.templates.fragment.append(document.importNode(this.templates.content,!0))})),this.parent.$element.insertBefore(this.templates.fragment,this.parent.$element.children[this.pos])}}class l extends r{constructor(t){super(t),this.variable=this.attr.values.original.replace("this.data.",""),this.inputType=this.$element.type,"checkbox"==this.inputType&&(this.related=[...this.parent.$element.querySelectorAll(`input[type='checkbox'][data-model='this.data.${this.variable}']`)].filter((t=>t!=this.$element))),this.ifAttrIsEmpty(this.attr),this.readAttribute((()=>{if(!this.attr?.values.original.match(s.$data))throw new SyntaxError("The 'data-model' attribute only accept a property reference as value")}))}bindData(){["radio","checkbox"].includes(this.inputType)||(this.$element.value=String(this.parent.data[this.variable]))}refresh(){this.parent.data[this.variable]="checkbox"!=this.inputType?this.$element.value:this.related?.length&&0!=[...this.related,this.$element].filter((t=>t.checked)).length?[...this.related,this.$element].filter((t=>t.checked)).map((t=>t.value)):this.$element.checked}setAction(){this.$element.addEventListener("input",this.refresh.bind(this)),this.bindData()}}class h extends r{constructor(t){super(t),this.ifAttrIsEmpty(this.attr),this.readAttribute((()=>{if(s.isObject.test(this.attr?.values.original)||s.methodSyntax.test(this.attr?.values.original))throw new SyntaxError("The 'data-text' attribute only accept strings concatenation, template literals, and a variable as reference")}))}refresh(){this.$element.textContent=this.attr.values.current()}setAction(){this.attr.values.current=()=>t.parser({expr:this.attr?.values.original,node:this.parent,args:this.forVars}),this.refresh()}}class o extends r{constructor(t){super(t),this.display=getComputedStyle(this.$element).display,this.ifAttrIsEmpty(this.attr),this.readAttribute((()=>{if(!s.isBoolean.test(this.attr.values.original)&&!s.isLogicalExpression.test(this.attr.values.original)||[...this.forVars.keys()].some((t=>!this.attr.values.original.includes(t))))throw new SyntaxError("data-show attribute only accept booleans")}))}refresh(){this.$element.style.display=this.attr.values.current()?this.display:"none"}setAction(){this.attr.values.current=()=>t.parser({expr:this.attr.values.original,node:this.parent,args:this.forVars}),this.refresh()}}var d;!function(t){t[t.async=0]="async",t[t.autocomplete=1]="autocomplete",t[t.autofocus=2]="autofocus",t[t.autoplay=3]="autoplay",t[t.border=4]="border",t[t.challenge=5]="challenge",t[t.checked=6]="checked",t[t.compact=7]="compact",t[t.contenteditable=8]="contenteditable",t[t.controls=9]="controls",t[t.default=10]="default",t[t.defer=11]="defer",t[t.disabled=12]="disabled",t[t.formNoValidate=13]="formNoValidate",t[t.frameborder=14]="frameborder",t[t.hidden=15]="hidden",t[t.indeterminate=16]="indeterminate",t[t.ismap=17]="ismap",t[t.loop=18]="loop",t[t.multiple=19]="multiple",t[t.muted=20]="muted",t[t.nohref=21]="nohref",t[t.noresize=22]="noresize",t[t.noshade=23]="noshade",t[t.novalidate=24]="novalidate",t[t.nowrap=25]="nowrap",t[t.open=26]="open",t[t.readonly=27]="readonly",t[t.required=28]="required",t[t.reversed=29]="reversed",t[t.scoped=30]="scoped",t[t.scrolling=31]="scrolling",t[t.seamless=32]="seamless",t[t.selected=33]="selected",t[t.sortable=34]="sortable",t[t.spellcheck=35]="spellcheck",t[t.translate=36]="translate"}(d||(d={}));class c extends r{constructor(t){super(t),t.attr.some((t=>this.ifAttrIsEmpty(t))),this.attr=t.attr.map((t=>({attribute:t.attribute,values:{original:t.values.original},bindAttr:t.attribute.replace(s.bindAndOn,""),bindValue:this.$element.getAttribute(t.attribute.replace(s.bindAndOn,""))||"",type:s.isString.test(t.values.original)?"string":s.isObject.test(t.values.original)?"object":"variable"}))),this.readAttribute((()=>{if(this.attr.some((t=>!(s.isString.test(t.values.original)||s.isObject.test(t.values.original)||s.isLogicalExpression.test(t.values.original)||s.isBoolean.test(t.values.original)))))throw new SyntaxError("A 'data-bind' attribute only accepts an object or a template string as value")}))}refresh(){this.attr.forEach((t=>t.predicate()))}attributeForEach(e){this.attr.filter(e.filter).forEach((a=>{let s=this.attr.indexOf(a);this.attr[s].values.current=()=>t.parser({expr:this.attr[s].values.original,node:this.parent,args:this.forVars}),e.callback(a)}))}setBooleanAttributes(){this.attributeForEach({filter:t=>Object.values(d).includes(t.bindAttr),callback:t=>{t.predicate=()=>this.$element[t.bindAttr]=t.values.current()}})}setAttributes(){this.attributeForEach({filter:t=>!["style","class"].includes(t.bindAttr)&&!Object.values(d).includes(t.bindAttr),callback:t=>{t.predicate=()=>this.$element.setAttribute(t.bindAttr,t.values.current())}})}setAction(){if(this.attr.filter((t=>!["style","class"].includes(t.bindAttr))).some((t=>s.isObject.test(t.values.original))))throw new SyntaxError("Only 'style' and 'class' attribute accepts an object as value any other /\n                atttribute can only receive either a variable or a template string");this.attr.filter((t=>["style","class"].includes(t.bindAttr))).forEach((e=>{let a=this.attr.indexOf(e);this.attr[a].values.current=()=>t.parser({expr:this.attr[a].values.original,node:this.parent,args:this.forVars})}));const[e,a]=[this.attr.findIndex((t=>"style"==t.bindAttr)),this.attr.findIndex((t=>"class"==t.bindAttr))];this.attr[e]&&(this.attr[e].predicate=()=>["string","variable"].includes(this.attr[e].type)?this.$element.style.cssText=this.attr[e].values.current()+this.attr[e].bindValue:Object.assign(this.$element.style,this.attr[e].values.current())),this.attr[a]&&(this.attr[a].predicate=()=>this.$element.className=["string","variable"].includes(this.attr[a].type)?this.attr[a].values.current()+" ":Object.entries(this.attr[a].values.current()).filter((([,t])=>t)).map((([t])=>t)).join(" ")+" "+this.attr[a].bindValue),this.setAttributes(),this.setBooleanAttributes(),this.refresh()}}class u{constructor(e,a){if(this.data={},this.childs={"data-for":[],"data-text":[],"data-show":[],"data-model":[],"data-on":[],"data-bind":[]},({name:this.name,watch:this.watch,init:this.init,updated:this.updated,beforeUpdating:this.beforeUpdating}=e),this.$element=a,this.$element.dataset.inline&&this.$element.dataset.attached)throw new Error("A component cannot have both 'data-' attributes ('inline', 'attached')");if(this.id=this.$element.dataset.id=t.setId(),e.data&&(this.data=this.parseData(e.data)),e.methods&&(this.methods=this.parseMethods(e.methods)),this.watch&&Object.keys(this.watch).some((t=>{if(!this.data[t])throw new ReferenceError(`You're trying to watch an undefined property '${t}'`)})),this.$refs=this.findRefs(),null==this.init&&s.arguments.test(this.$element.dataset.init))throw new EvalError(`The ${this.name||"Some"} components don't have an init() function, therefore they do not accept any parameters`);this.init&&this.executeInit(),this.checkForActionsAndChilds(),Object.seal(this)}executeInit(){let e=t.parser({expr:"["+this.$element.dataset.init+"]"});return this.init instanceof Promise?(async()=>await this.init(...e))():this.init(...e)}findRefs(){return[...this.$element.querySelectorAll("*[data-ref]")].reduce(((t,e)=>{if(!e.dataset.ref)throw new SyntaxError("data-ref attribute cannot be empty");if(Object.keys({...t}).some((t=>t==e.dataset.ref)))throw new SyntaxError("It seems like there are repeated 'data-ref' values, check your 'data-ref' attributes");return{...t,[e.dataset.ref]:e}}),{})}refreshChilds(t,e){this.childs[t].filter((t=>t.attr?.values.original.includes(e))).forEach((t=>{t.refresh()}))}checkForActionsAndChilds(){if(this.$element.querySelectorAll("*[data-inline], *[data-attached]").length)throw Error("Child components is an unsupported feature, sorry about that");this.childs={"data-for":t.getElementsBy({attribute:"data-for",$element:this.$element,parent:this,selector:"template[data-for]",Child:n}),"data-text":t.getElementsBy({attribute:"data-text",$element:this.$element,parent:this,selector:"*[data-text]",Child:h}),"data-show":t.getElementsBy({attribute:"data-show",$element:this.$element,parent:this,selector:"*[data-show]",Child:o}),"data-model":t.getElementsBy({attribute:"data-model",$element:this.$element,parent:this,selector:"input[data-model], select[data-model], textarea[data-model]",Child:l}),"data-on":t.getElementsByDataOn({attribute:"on",Child:i,parent:this,rescan:!1}),"data-bind":t.getElementsByDataOn({attribute:"bind",Child:c,parent:this,rescan:!1})}}$emitSelf(t){this.childs["data-on"].filter((e=>e.attr.some((e=>e.attribute.includes(t.name)&&!e.attribute.includes("window"))))).forEach((e=>e.$element.dispatchEvent(new CustomEvent(t.name,{detail:t.detail,bubbles:!0,composed:!0,cancelable:!0}))))}$emit(t){window.dispatchEvent(new CustomEvent(t.name,{detail:t.detail,bubbles:!0,composed:!0,cancelable:!0}))}reScan(){this.$refs=this.findRefs();const e=(e,a)=>[...this.childs[`data-${e}`],...t.getElementsBy({attribute:`data-${e}`,$element:this.$element,parent:this,selector:`*[data-${e}][data-key]`,Child:a})],a=(e,a)=>[...this.childs[`data-${e}`],...t.getElementsByDataOn({attribute:e,Child:a,parent:this,rescan:!0})];[this.childs["data-text"],this.childs["data-show"],this.childs["data-on"],this.childs["data-model"],this.childs["data-bind"]]=[e("text",h),e("show",o),e("model",l),a("on",i),a("bind",c)]}updateRelated(t){this.childs["data-for"].filter((e=>e.variables.parent.includes(t))).forEach((t=>t.refresh())),["data-show","data-text"].forEach((e=>this.refreshChilds(e,t))),this.childs["data-model"].filter((e=>e.variable==t)).forEach((t=>t.bindData())),this.childs["data-bind"].filter((e=>e.attr.some((e=>e.values.original.includes(t))))).forEach((t=>t.refresh()))}parseMethods(t){return Object.values(t).reduce(((t,e)=>({...t,[e.name]:new Proxy(e,{apply:(t,e,a)=>{this.beforeUpdating&&this.beforeUpdating();const s=t.apply(this,[...a]);return this.updated&&this.updated(),s}})})),{})}parseData(e){return t.reactive({object:e,beforeSet:(t,e,a)=>{this.beforeUpdating&&this.beforeUpdating(),this.watch&&this.watch[e]?.apply(this,[a,t[e]])},afterSet:(t,e)=>{this.updateRelated(e),this.updated&&this.updated()}})}}class p extends u{constructor(t,e){super(t,e)}}class m extends u{constructor(e){super(t.parser({expr:e.dataset.inline||"{}"}),e)}}const b={search(...t){[...document.querySelectorAll("*[data-attached]")].map((t=>({el:t,attr:t.dataset.attached}))).forEach((e=>{const a=(()=>{let a=t.find((t=>t.name==e.attr.trim()));if(!a)throw new ReferenceError(`'${a}' couldn't be found in any of your declared components`);return a})();new p(a,e.el)})),this.searchInlines()},make(t,...e){e.forEach((e=>new p(t,e)))},searchInlines(){[...document.querySelectorAll("*[data-inline]")].forEach((t=>new m(t)))}};Object.defineProperty(window,"Chevere",{value:b})})();